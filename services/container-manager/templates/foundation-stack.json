{
  "name": "foundation-stack",
  "description": "Systems 1-7: PostgreSQL, Redis, Vault, MinIO, Prometheus, Loki, Traefik — Core infrastructure services",
  "categories": ["infrastructure", "foundation"],
  "compose": "version: '3.8'\n\nservices:\n  # System 1 — PostgreSQL\n  omni-postgres:\n    image: postgres:16-alpine\n    container_name: omni-postgres\n    restart: unless-stopped\n    environment:\n      POSTGRES_USER: ${POSTGRES_USER}\n      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}\n      POSTGRES_DB: omni_quantum\n    volumes:\n      - postgres-data:/var/lib/postgresql/data\n    ports:\n      - '5432:5432'\n    labels:\n      omni_quantum_component: postgres\n      omni_quantum_tier: critical\n      omni_quantum_system: '1'\n      omni_quantum_stack: foundation\n    healthcheck:\n      test: ['CMD-SHELL', 'pg_isready -U ${POSTGRES_USER}']\n      interval: 10s\n      timeout: 5s\n      retries: 5\n    networks:\n      - omni-quantum-network\n\n  # System 1 — Redis\n  omni-redis:\n    image: redis:7-alpine\n    container_name: omni-redis\n    restart: unless-stopped\n    command: redis-server --requirepass ${REDIS_PASSWORD} --maxmemory 512mb --maxmemory-policy allkeys-lru\n    volumes:\n      - redis-data:/data\n    ports:\n      - '6379:6379'\n    labels:\n      omni_quantum_component: redis\n      omni_quantum_tier: critical\n      omni_quantum_system: '1'\n      omni_quantum_stack: foundation\n    healthcheck:\n      test: ['CMD', 'redis-cli', '-a', '${REDIS_PASSWORD}', 'ping']\n      interval: 10s\n      timeout: 5s\n      retries: 5\n    networks:\n      - omni-quantum-network\n\n  # System 3 — MinIO\n  omni-minio:\n    image: minio/minio:latest\n    container_name: omni-minio\n    restart: unless-stopped\n    command: server /data --console-address ':9001'\n    environment:\n      MINIO_ROOT_USER: ${MINIO_ACCESS_KEY}\n      MINIO_ROOT_PASSWORD: ${MINIO_SECRET_KEY}\n    volumes:\n      - minio-data:/data\n    ports:\n      - '9000:9000'\n      - '9001:9001'\n    labels:\n      omni_quantum_component: minio\n      omni_quantum_tier: critical\n      omni_quantum_system: '3'\n      omni_quantum_stack: foundation\n    healthcheck:\n      test: ['CMD', 'curl', '-f', 'http://localhost:9000/minio/health/live']\n      interval: 30s\n      timeout: 10s\n      retries: 3\n    networks:\n      - omni-quantum-network\n\n  # System 4 — Vault\n  omni-vault:\n    image: hashicorp/vault:1.15\n    container_name: omni-vault\n    restart: unless-stopped\n    cap_add:\n      - IPC_LOCK\n    environment:\n      VAULT_ADDR: http://0.0.0.0:8200\n    volumes:\n      - vault-data:/vault/data\n      - ./vault-config:/vault/config\n    ports:\n      - '8200:8200'\n    labels:\n      omni_quantum_component: vault\n      omni_quantum_tier: critical\n      omni_quantum_system: '4'\n      omni_quantum_stack: foundation\n    healthcheck:\n      test: ['CMD', 'vault', 'status']\n      interval: 30s\n      timeout: 10s\n      retries: 3\n    networks:\n      - omni-quantum-network\n\n  # System 5 — Prometheus\n  omni-prometheus:\n    image: prom/prometheus:v2.48.0\n    container_name: omni-prometheus\n    restart: unless-stopped\n    command:\n      - '--config.file=/etc/prometheus/prometheus.yml'\n      - '--storage.tsdb.path=/prometheus'\n      - '--storage.tsdb.retention.time=15d'\n      - '--web.enable-lifecycle'\n    volumes:\n      - prometheus-data:/prometheus\n      - ./prometheus-config:/etc/prometheus\n    ports:\n      - '9090:9090'\n    labels:\n      omni_quantum_component: prometheus\n      omni_quantum_tier: high\n      omni_quantum_system: '5'\n      omni_quantum_stack: foundation\n    healthcheck:\n      test: ['CMD', 'wget', '--spider', '-q', 'http://localhost:9090/-/healthy']\n      interval: 15s\n      timeout: 5s\n      retries: 3\n    networks:\n      - omni-quantum-network\n\n  # System 6 — Loki\n  omni-loki:\n    image: grafana/loki:2.9.3\n    container_name: omni-loki\n    restart: unless-stopped\n    command: -config.file=/etc/loki/loki-enhanced.yml\n    volumes:\n      - loki-data:/loki\n      - ./loki-config:/etc/loki\n    ports:\n      - '3100:3100'\n    labels:\n      omni_quantum_component: loki\n      omni_quantum_tier: high\n      omni_quantum_system: '6'\n      omni_quantum_stack: foundation\n    healthcheck:\n      test: ['CMD', 'wget', '--spider', '-q', 'http://localhost:3100/ready']\n      interval: 15s\n      timeout: 5s\n      retries: 3\n    networks:\n      - omni-quantum-network\n\n  # System 7 — Grafana\n  omni-grafana:\n    image: grafana/grafana:10.2.0\n    container_name: omni-grafana\n    restart: unless-stopped\n    environment:\n      GF_SECURITY_ADMIN_PASSWORD: ${GRAFANA_ADMIN_PASSWORD}\n      GF_AUTH_GENERIC_OAUTH_ENABLED: 'true'\n    volumes:\n      - grafana-data:/var/lib/grafana\n      - ./grafana-dashboards:/etc/grafana/provisioning/dashboards\n      - ./grafana-datasources:/etc/grafana/provisioning/datasources\n    ports:\n      - '3000:3000'\n    labels:\n      omni_quantum_component: grafana\n      omni_quantum_tier: high\n      omni_quantum_system: '7'\n      omni_quantum_stack: foundation\n    healthcheck:\n      test: ['CMD', 'wget', '--spider', '-q', 'http://localhost:3000/api/health']\n      interval: 15s\n      timeout: 5s\n      retries: 3\n    networks:\n      - omni-quantum-network\n\nvolumes:\n  postgres-data:\n  redis-data:\n  minio-data:\n  vault-data:\n  prometheus-data:\n  loki-data:\n  grafana-data:\n\nnetworks:\n  omni-quantum-network:\n    external: true\n"
}
