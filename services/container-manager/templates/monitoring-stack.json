{
  "name": "monitoring-stack",
  "description": "Systems 5,6,13,29-31: Prometheus, Loki, Langfuse, Enhanced Monitoring, Log Pattern Detector, Uptime Monitor",
  "categories": ["monitoring", "observability"],
  "compose": "version: '3.8'\n\nservices:\n  # System 5 — Alertmanager\n  omni-alertmanager:\n    image: prom/alertmanager:v0.26.0\n    container_name: omni-alertmanager\n    restart: unless-stopped\n    command:\n      - '--config.file=/etc/alertmanager/alertmanager.yml'\n      - '--storage.path=/alertmanager'\n    volumes:\n      - alertmanager-data:/alertmanager\n      - ./alertmanager-config:/etc/alertmanager\n    ports:\n      - '9093:9093'\n    labels:\n      omni_quantum_component: alertmanager\n      omni_quantum_tier: high\n      omni_quantum_system: '5'\n      omni_quantum_stack: monitoring\n    healthcheck:\n      test: ['CMD', 'wget', '--spider', '-q', 'http://localhost:9093/-/healthy']\n      interval: 15s\n      timeout: 5s\n      retries: 3\n    networks:\n      - omni-quantum-network\n\n  # System 5 — Thanos Query\n  omni-thanos-query:\n    image: thanosio/thanos:v0.32.5\n    container_name: omni-thanos-query\n    restart: unless-stopped\n    command:\n      - query\n      - '--http-address=0.0.0.0:9090'\n      - '--store=omni-thanos-sidecar:10901'\n      - '--store=omni-thanos-store:10901'\n    ports:\n      - '9091:9090'\n    labels:\n      omni_quantum_component: thanos-query\n      omni_quantum_tier: high\n      omni_quantum_system: '5'\n      omni_quantum_stack: monitoring\n    networks:\n      - omni-quantum-network\n\n  # System 6 — Promtail\n  omni-promtail:\n    image: grafana/promtail:2.9.3\n    container_name: omni-promtail\n    restart: unless-stopped\n    command: -config.file=/etc/promtail/promtail-enhanced.yml\n    volumes:\n      - ./promtail-config:/etc/promtail\n      - /var/run/docker.sock:/var/run/docker.sock:ro\n      - /var/lib/docker/containers:/var/lib/docker/containers:ro\n      - /var/log:/var/log:ro\n      - promtail-positions:/tmp\n    ports:\n      - '9080:9080'\n    labels:\n      omni_quantum_component: promtail\n      omni_quantum_tier: high\n      omni_quantum_system: '6'\n      omni_quantum_stack: monitoring\n    networks:\n      - omni-quantum-network\n\n  # System 13 — Langfuse\n  omni-langfuse:\n    image: langfuse/langfuse:latest\n    container_name: omni-langfuse\n    restart: unless-stopped\n    environment:\n      DATABASE_URL: postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@omni-postgres:5432/langfuse\n      NEXTAUTH_URL: https://langfuse.omni-quantum.internal\n      NEXTAUTH_SECRET: ${LANGFUSE_NEXTAUTH_SECRET}\n      SALT: ${LANGFUSE_SALT}\n    ports:\n      - '3050:3000'\n    labels:\n      omni_quantum_component: langfuse\n      omni_quantum_tier: high\n      omni_quantum_system: '13'\n      omni_quantum_stack: monitoring\n    healthcheck:\n      test: ['CMD', 'curl', '-f', 'http://localhost:3000/api/public/health']\n      interval: 30s\n      timeout: 10s\n      retries: 3\n    networks:\n      - omni-quantum-network\n\n  # System 13 — Trace Correlator\n  omni-trace-correlator:\n    image: omni-quantum/trace-correlator:latest\n    container_name: omni-trace-correlator\n    restart: unless-stopped\n    environment:\n      LANGFUSE_URL: http://omni-langfuse:3000\n      LANGFUSE_PUBLIC_KEY: ${LANGFUSE_PUBLIC_KEY}\n      LANGFUSE_SECRET_KEY: ${LANGFUSE_SECRET_KEY}\n      LOKI_URL: http://omni-loki:3100\n    ports:\n      - '3051:3001'\n    labels:\n      omni_quantum_component: trace-correlator\n      omni_quantum_tier: standard\n      omni_quantum_system: '13'\n      omni_quantum_stack: monitoring\n    networks:\n      - omni-quantum-network\n\n  # System 29 — Enhanced Monitoring (Node Exporter + cAdvisor)\n  omni-node-exporter:\n    image: prom/node-exporter:v1.7.0\n    container_name: omni-node-exporter\n    restart: unless-stopped\n    command:\n      - '--path.rootfs=/host'\n    volumes:\n      - /:/host:ro,rslave\n    ports:\n      - '9100:9100'\n    labels:\n      omni_quantum_component: node-exporter\n      omni_quantum_tier: standard\n      omni_quantum_system: '29'\n      omni_quantum_stack: monitoring\n    networks:\n      - omni-quantum-network\n\n  omni-cadvisor:\n    image: gcr.io/cadvisor/cadvisor:v0.47.2\n    container_name: omni-cadvisor\n    restart: unless-stopped\n    privileged: true\n    volumes:\n      - /:/rootfs:ro\n      - /var/run:/var/run:ro\n      - /sys:/sys:ro\n      - /var/lib/docker/:/var/lib/docker:ro\n    ports:\n      - '8085:8080'\n    labels:\n      omni_quantum_component: cadvisor\n      omni_quantum_tier: standard\n      omni_quantum_system: '29'\n      omni_quantum_stack: monitoring\n    networks:\n      - omni-quantum-network\n\n  # System 30 — Log Pattern Detector\n  omni-log-pattern-detector:\n    image: omni-quantum/log-pattern-detector:latest\n    container_name: omni-log-pattern-detector\n    restart: unless-stopped\n    environment:\n      LOKI_URL: http://omni-loki:3100\n      PROMETHEUS_URL: http://omni-prometheus:9090\n    ports:\n      - '9301:9301'\n    labels:\n      omni_quantum_component: log-pattern-detector\n      omni_quantum_tier: standard\n      omni_quantum_system: '30'\n      omni_quantum_stack: monitoring\n    networks:\n      - omni-quantum-network\n\n  # System 31 — Uptime Monitor (Uptime Kuma)\n  omni-uptime-kuma:\n    image: louislam/uptime-kuma:latest\n    container_name: omni-uptime-kuma\n    restart: unless-stopped\n    volumes:\n      - uptime-kuma-data:/app/data\n    ports:\n      - '3060:3001'\n    labels:\n      omni_quantum_component: uptime-kuma\n      omni_quantum_tier: standard\n      omni_quantum_system: '31'\n      omni_quantum_stack: monitoring\n    networks:\n      - omni-quantum-network\n\nvolumes:\n  alertmanager-data:\n  promtail-positions:\n  uptime-kuma-data:\n\nnetworks:\n  omni-quantum-network:\n    external: true\n"
}
