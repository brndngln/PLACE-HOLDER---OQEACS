{
  "name": "security-stack",
  "description": "Systems 2,4,25,33,34: Authentik, Vault, Falco, Enhanced Secrets, Enhanced Proxy (Traefik)",
  "categories": ["security", "authentication"],
  "compose": "version: '3.8'\n\nservices:\n  # System 2 — Authentik Server\n  omni-authentik:\n    image: ghcr.io/goauthentik/server:latest\n    container_name: omni-authentik\n    restart: unless-stopped\n    command: server\n    environment:\n      AUTHENTIK_REDIS__HOST: omni-redis\n      AUTHENTIK_REDIS__PASSWORD: ${REDIS_PASSWORD}\n      AUTHENTIK_POSTGRESQL__HOST: omni-postgres\n      AUTHENTIK_POSTGRESQL__USER: ${POSTGRES_USER}\n      AUTHENTIK_POSTGRESQL__NAME: authentik\n      AUTHENTIK_POSTGRESQL__PASSWORD: ${POSTGRES_PASSWORD}\n      AUTHENTIK_SECRET_KEY: ${AUTHENTIK_SECRET_KEY}\n    ports:\n      - '9000:9000'\n      - '9443:9443'\n    labels:\n      omni_quantum_component: authentik\n      omni_quantum_tier: critical\n      omni_quantum_system: '2'\n      omni_quantum_stack: security\n    healthcheck:\n      test: ['CMD', 'wget', '--spider', '-q', 'http://localhost:9000/-/health/live/']\n      interval: 30s\n      timeout: 10s\n      retries: 3\n    networks:\n      - omni-quantum-network\n\n  omni-authentik-worker:\n    image: ghcr.io/goauthentik/server:latest\n    container_name: omni-authentik-worker\n    restart: unless-stopped\n    command: worker\n    environment:\n      AUTHENTIK_REDIS__HOST: omni-redis\n      AUTHENTIK_REDIS__PASSWORD: ${REDIS_PASSWORD}\n      AUTHENTIK_POSTGRESQL__HOST: omni-postgres\n      AUTHENTIK_POSTGRESQL__USER: ${POSTGRES_USER}\n      AUTHENTIK_POSTGRESQL__NAME: authentik\n      AUTHENTIK_POSTGRESQL__PASSWORD: ${POSTGRES_PASSWORD}\n      AUTHENTIK_SECRET_KEY: ${AUTHENTIK_SECRET_KEY}\n    labels:\n      omni_quantum_component: authentik-worker\n      omni_quantum_tier: critical\n      omni_quantum_system: '2'\n      omni_quantum_stack: security\n    networks:\n      - omni-quantum-network\n\n  # System 25 — Falco\n  omni-falco:\n    image: falcosecurity/falco:latest\n    container_name: omni-falco\n    restart: unless-stopped\n    privileged: true\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock:ro\n      - /proc:/host/proc:ro\n      - /boot:/host/boot:ro\n      - /lib/modules:/host/lib/modules:ro\n      - ./falco-config:/etc/falco\n    labels:\n      omni_quantum_component: falco\n      omni_quantum_tier: high\n      omni_quantum_system: '25'\n      omni_quantum_stack: security\n    networks:\n      - omni-quantum-network\n\n  # System 33 — Enhanced Secrets (Vault Agent)\n  omni-vault-agent:\n    image: hashicorp/vault:1.15\n    container_name: omni-vault-agent\n    restart: unless-stopped\n    command: agent -config=/vault/config/agent.hcl\n    environment:\n      VAULT_ADDR: http://omni-vault:8200\n    volumes:\n      - ./vault-agent-config:/vault/config\n      - vault-agent-data:/vault/data\n    labels:\n      omni_quantum_component: vault-agent\n      omni_quantum_tier: high\n      omni_quantum_system: '33'\n      omni_quantum_stack: security\n    networks:\n      - omni-quantum-network\n\n  # System 34 — Enhanced Proxy (Traefik)\n  omni-traefik:\n    image: traefik:v3.0\n    container_name: omni-traefik\n    restart: unless-stopped\n    command:\n      - '--api.dashboard=true'\n      - '--providers.docker=true'\n      - '--providers.docker.exposedbydefault=false'\n      - '--entrypoints.web.address=:80'\n      - '--entrypoints.websecure.address=:443'\n      - '--certificatesresolvers.letsencrypt.acme.tlschallenge=true'\n      - '--accesslog=true'\n      - '--accesslog.filepath=/var/log/traefik/access.log'\n      - '--accesslog.format=json'\n      - '--log.filepath=/var/log/traefik/traefik.log'\n      - '--log.format=json'\n      - '--metrics.prometheus=true'\n      - '--metrics.prometheus.entryPoint=metrics'\n      - '--entrypoints.metrics.address=:8082'\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock:ro\n      - traefik-certs:/letsencrypt\n      - traefik-logs:/var/log/traefik\n    ports:\n      - '80:80'\n      - '443:443'\n      - '8082:8082'\n    labels:\n      omni_quantum_component: traefik\n      omni_quantum_tier: critical\n      omni_quantum_system: '34'\n      omni_quantum_stack: security\n    healthcheck:\n      test: ['CMD', 'traefik', 'healthcheck', '--ping']\n      interval: 10s\n      timeout: 5s\n      retries: 3\n    networks:\n      - omni-quantum-network\n\nvolumes:\n  vault-agent-data:\n  traefik-certs:\n  traefik-logs:\n\nnetworks:\n  omni-quantum-network:\n    external: true\n"
}
